name: Test SPaDE Integration

on:
  workflow_dispatch:
    inputs:
      test_branch:
        description: 'Branch to test (default: current)'
        required: false
        default: ''

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}/proofpower

jobs:
  test-spade:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/${{ github.repository }}/proofpower:latest
      credentials:
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.inputs.test_branch || github.ref }}
      
      - name: Set up ProofPower environment
        run: |
          # Source the ProofPower environment
          . /proofpower/dev_env
          echo "PPDIR=/proofpower" >> $GITHUB_ENV
          echo "/proofpower/bld/bin" >> $GITHUB_PATH
      
      - name: Test HOL theory scraping
        run: |
          # Add your test commands here
          echo "Testing HOL theory hierarchy scraping..."
          
          # Example: Test that HOL database is accessible
          pp -d hol <<< "get_theory \"basic_hol\";"
          
          # Example: Run your SPaDE integration tests
          # python test_spade_scraper.py
          
      - name: Run SPaDE integration tests
        run: |
          # Add specific test commands for your SPaDE scraper
          echo "Running SPaDE repository tests..."
          # Your test script here